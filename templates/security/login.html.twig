{% extends 'base.html.twig' %}

{% block title %}Connexion - C2E Gestion d'Équipements
{% endblock %}

{% block body %}
	<div class="container-fluid">
		<div class="row justify-content-center align-items-center min-vh-100">
			<div class="col-md-8 col-lg-6 col-xl-4">
				<div class="card shadow-lg border-0">
					<div class="card-body p-5">
						<div class="text-center mb-5">
							<img src="{{ asset('logo_c2e_baseline2.png') }}" alt="C2E Logo" style="height: 80px;">
							<h3 class="mt-3" style="color: #764ba2;">Gestion d'Équipements</h3>
							<p class="text-muted">Veuillez vous connecter pour accéder au système</p>
						</div>

						{% if error %}
							<div class="alert alert-danger alert-dismissible fade show">
								<i class="bi bi-exclamation-triangle-fill me-2"></i>
								{{ error.messageKey|trans(error.messageData, 'security') }}
								<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
							</div>
						{% endif %}

						<form method="post" action="{{ path('app_login') }}" class="needs-validation" novalidate>
							{% if error %}
								<div class="alert alert-danger alert-dismissible fade show">
									<i class="bi bi-exclamation-triangle-fill me-2"></i>
									{{ error.messageKey|trans(error.messageData, 'security') }}
									<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
								</div>
							{% endif %}

							<div class="mb-4">
								<label for="inputUsername" class="form-label">Nom d'utilisateur</label>
								<div class="input-group">
									<span class="input-group-text">
										<i class="bi bi-person-fill"></i>
									</span>
									<input type="text" value="{{ last_username }}" name="username" id="inputUsername" class="form-control" autocomplete="username" required autofocus>
								</div>
							</div>

							<div class="mb-4">
								<label for="inputPassword" class="form-label">Mot de passe</label>
								<div class="input-group">
									<span class="input-group-text">
										<i class="bi bi-lock-fill"></i>
									</span>
									<input type="password" name="password" id="inputPassword" class="form-control" autocomplete="current-password" required>
								</div>
							</div>

							<input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">

							<div class="mb-4 form-check">
								<input type="checkbox" class="form-check-input" id="rememberMe" name="_remember_me">
								<label class="form-check-label" for="rememberMe">Se souvenir de moi</label>
							</div>

							<button type="submit" class="btn btn-primary w-100 py-2">
								<i class="bi bi-box-arrow-in-right me-2"></i>
								Connexion
							</button>
						</form>
					</div>
					<div class="card-footer text-center py-3">
						<p class="text-muted mb-0">©
							{{ "now"|date('Y') }}
							C2E. Tous droits réservés.</p>
					</div>
				</div>
			</div>
		</div>
	</div>

	<style>
		body {
			background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
			font-family: 'Inter', sans-serif;
		}
		.card {
			border-radius: 16px;
			overflow: hidden;
			border: none;
		}
		.form-control {
			border-radius: 8px;
			padding: 12px 15px;
		}
		.form-control:focus {
			border-color: #764ba2;
			box-shadow: 0 0 0 0.25rem rgba(118, 75, 162, 0.25);
		}
		.btn-primary {
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			border: none;
			padding: 12px;
			border-radius: 8px;
			font-weight: 600;
			transition: all 0.3s ease;
		}
		.btn-primary:hover {
			background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
			transform: translateY(-2px);
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
		}
		.input-group-text {
			background-color: #f8f9fa;
			border-right: none;
		}
		.input-group .form-control {
			border-left: none;
		}
	</style>

    <script>
    // Validation des champs
    (() => {
        'use strict'
        const forms = document.querySelectorAll('.needs-validation')
        Array.from(forms).forEach(form => {
            form.addEventListener('submit', event => {
                if (!form.checkValidity()) {
                    event.preventDefault()
                    event.stopPropagation()
                }
                form.classList.add('was-validated')
            }, false)
        })
    })()
    </script>
{% endblock %}
